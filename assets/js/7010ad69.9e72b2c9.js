"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[458],{3905:function(e,t,n){n.d(t,{Zo:function(){return d},kt:function(){return p}});var a=n(7294);function s(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function r(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){s(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function i(e,t){if(null==e)return{};var n,a,s=function(e,t){if(null==e)return{};var n,a,s={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(s[n]=e[n]);return s}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(s[n]=e[n])}return s}var l=a.createContext({}),c=function(e){var t=a.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):r(r({},t),e)),n},d=function(e){var t=c(e.components);return a.createElement(l.Provider,{value:t},e.children)},m={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},u=a.forwardRef((function(e,t){var n=e.components,s=e.mdxType,o=e.originalType,l=e.parentName,d=i(e,["components","mdxType","originalType","parentName"]),u=c(n),p=s,h=u["".concat(l,".").concat(p)]||u[p]||m[p]||o;return n?a.createElement(h,r(r({ref:t},d),{},{components:n})):a.createElement(h,r({ref:t},d))}));function p(e,t){var n=arguments,s=t&&t.mdxType;if("string"==typeof e||s){var o=n.length,r=new Array(o);r[0]=u;var i={};for(var l in t)hasOwnProperty.call(t,l)&&(i[l]=t[l]);i.originalType=e,i.mdxType="string"==typeof e?e:s,r[1]=i;for(var c=2;c<o;c++)r[c]=n[c];return a.createElement.apply(null,r)}return a.createElement.apply(null,n)}u.displayName="MDXCreateElement"},7580:function(e,t,n){n.r(t),n.d(t,{assets:function(){return l},contentTitle:function(){return r},default:function(){return m},frontMatter:function(){return o},metadata:function(){return i},toc:function(){return c}});var a=n(3117),s=(n(7294),n(3905));const o={sidebar_position:2},r="Basics of Smart Contract Interaction",i={unversionedId:"smart-contract-interaction/interact",id:"smart-contract-interaction/interact",title:"Basics of Smart Contract Interaction",description:"Smart contracts are executable codes. Normally, smart contracts are developed using Rust, compiled into WebAssembly (wasm) and finally code-optimized before being uploaded to the chain. Before moving forward and learning how to develop one, let us first deploy and interact with an existing smart contract to keep things simple. There are currently two options for deploying and interacting with contracts: wasmd and CosmJS.",source:"@site/dev-academy/smart-contract-interaction/02-interact.md",sourceDirName:"smart-contract-interaction",slug:"/smart-contract-interaction/interact",permalink:"/dev-academy/smart-contract-interaction/interact",draft:!1,editUrl:"https://github.com/InterWasm/docs/edit/main/dev-academy/smart-contract-interaction/02-interact.md",tags:[],version:"current",sidebarPosition:2,frontMatter:{sidebar_position:2},sidebar:"devAcademy",previous:{title:"What are Smart Contracts?",permalink:"/dev-academy/smart-contract-interaction/what-is-smart-contracts"},next:{title:"Challenge",permalink:"/dev-academy/smart-contract-interaction/challenge"}},l={},c=[{value:"Where to find smart contracts?",id:"where-to-find-smart-contracts",level:2},{value:"Download",id:"download",level:2},{value:"Deployment",id:"deployment",level:2},{value:"Instantiate",id:"instantiate",level:3},{value:"CosmJS",id:"cosmjs",level:2},{value:"Setting up the CosmJS CLI Client",id:"setting-up-the-cosmjs-cli-client",level:3},{value:"Reloading your Wallet",id:"reloading-your-wallet",level:3},{value:"Example: STAR",id:"example-star",level:3},{value:"Instantiating a New Contract",id:"instantiating-a-new-contract",level:3},{value:"Utilizing Contract Functions",id:"utilizing-contract-functions",level:3}],d={toc:c};function m(e){let{components:t,...n}=e;return(0,s.kt)("wrapper",(0,a.Z)({},d,n,{components:t,mdxType:"MDXLayout"}),(0,s.kt)("h1",{id:"basics-of-smart-contract-interaction"},"Basics of Smart Contract Interaction"),(0,s.kt)("p",null,"Smart contracts are executable codes. Normally, smart contracts are developed using Rust, compiled into WebAssembly (wasm) and finally code-optimized before being uploaded to the chain. Before moving forward and learning how to develop one, let us first deploy and interact with an existing smart contract to keep things simple. There are currently two options for deploying and interacting with contracts: ",(0,s.kt)("inlineCode",{parentName:"p"},"wasmd")," and ",(0,s.kt)("inlineCode",{parentName:"p"},"CosmJS"),"."),(0,s.kt)("h2",{id:"where-to-find-smart-contracts"},"Where to find smart contracts?"),(0,s.kt)("p",null,"A good number of smart contract binary executables are provided in the ",(0,s.kt)("a",{parentName:"p",href:"https://github.com/CosmWasm/cw-plus/"},"cw-plus")," repository alongside the code.\nThe ",(0,s.kt)("a",{parentName:"p",href:"https://github.com/CosmWasm/cw-plus/"},"cw-plus")," repository is a collection of production-grade smart contracts that has been heavily tested on real mainnets.\nYou will see a list of available contracts on the repository page.\nYou may click on the ",(0,s.kt)("strong",{parentName:"p"},"Releases")," button to see tagged binary executables, download the binaries and deploy them to\ncompatible blockchains."),(0,s.kt)("h2",{id:"download"},"Download"),(0,s.kt)("p",null,"Now, let us download a pre-built smart contract developed by the CosmWasm team. Click on the following link to download the cw20 pre-built binary."),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("a",{parentName:"li",href:"https://github.com/CosmWasm/cw-plus/releases/download/v0.10.0/cw20_base.wasm"},"cw20_base.wasm"))),(0,s.kt)("p",null,"Please don't pay attention to cw20-base details for now, just focus on getting a contract on the testnet first."),(0,s.kt)("h2",{id:"deployment"},"Deployment"),(0,s.kt)("p",null,"We will deploy the code using the ",(0,s.kt)("inlineCode",{parentName:"p"},"wasmd")," CLI that was installed ",(0,s.kt)("a",{parentName:"p",href:"/dev-academy/basics/environment#wasmd"},"earlier"),". Please make sure you've set up a wallet and requested some ",(0,s.kt)("inlineCode",{parentName:"p"},"umlg"),"s from the faucet beforehand."),(0,s.kt)("p",null,"Open a new terminal window and make sure the present working directory contains the cw20_base.wasm binary."),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-sh"},"# Setting up the correct parameters\nexport TXFLAG=\"--node https://rpc.malaga-420.cosmwasm.com:443 --chain-id malaga-420 --gas-prices 0.25umlg --gas auto --gas-adjustment 1.3 -y --output json -b block\"\n\n# Storing the binary on chain\nRES=$(wasmd tx wasm store cw20_base.wasm --from wallet $TXFLAG)\n\n# Getting the code id for the stored binary\nCODE_ID=$(echo $RES | jq -r '.logs[0].events[1].attributes[0].value')\n\n# Printing the code id\necho $CODE_ID\n\n# Querying the list of contracts instantiated with the code id above\nwasmd query wasm list-contract-by-code $CODE_ID --node https://rpc.malaga-420.cosmwasm.com:443 --output json\n\n# This should return an empty list, for now.\n")),(0,s.kt)("p",null,"Now, the code is stored on the network and the ",(0,s.kt)("inlineCode",{parentName:"p"},"CODE_ID")," is the identifier of the code."),(0,s.kt)("h3",{id:"instantiate"},"Instantiate"),(0,s.kt)("p",null,"Smart contract code is just the blueprint of a smart contract. We ",(0,s.kt)("em",{parentName:"p"},"instantiate")," the smart contract based on this smart contract code. Before the smart contract can be utilized, an instance of the smart contract must be present with a smart contract address. "),(0,s.kt)("p",null,"Here is a sample instantiation message for the cw20-base contract:"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "name": "Golden Stars",\n  "symbol": "STAR",\n  "decimals": "2",\n  "initial_balances": [\n    {"address": "wasm1ez03me7uljk7qerswdp935vlaa4dlu48mys3mq", "amount": "10000"},\n    {"address": "wasm1tx7ga0lsnumd5hfsh2py0404sztnshwqaqjwy8", "amount": "10000"},\n    {"address": "wasm1mvjtezrn8dpateu0435trlw5062qy76gf738n0", "amount": "10000"}\n  ],\n  "mint": {\n    "minter": "wasm1mvjtezrn8dpateu0435trlw5062qy76gf738n0"\n  }\n}\n')),(0,s.kt)("p",null,"This message contains the initial state of the contract."),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-shell"},'# Modifying the instantiation message to include the current wallet address\nINIT=$(jq -n --arg wallet $(wasmd keys show -a wallet) \'{"name":"Golden Stars","symbol":"STAR","decimals":2,"initial_balances":[{"address":"wasm1n8aqd9jq9glhj87cn0nkmd5mslz3df8zm86hrh","amount":"10000"},{"address":"wasm13y4tpsgxza44yq76qvj69sakq4jmeyqudwgwpk","amount":"10000"},{"address":$wallet,"amount":"10000"}],"mint":{"minter":$wallet}}\')\n\n# Instantiating the contract\nwasmd tx wasm instantiate $CODE_ID "$INIT" --from wallet $TXFLAG --label "Our first cw20" --no-admin\n')),(0,s.kt)("p",null,"You will see an output that is similar to the one below, indicating that the instantiation was successful:"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-json"},'{\n   "height":"1837751",\n   "txhash":"9999EFF51367C40940478788A4E2FA3D9D5EA63C7B82D2891AB0E7F9C928011F",\n   "data":"0A6D0A282F636F736D7761736D2E7761736D2E76312E4D7367496E7374616E7469617465436F6E747261637412410A3F7761736D31327967757A7171676E76336A7130763476746130646B667776683861343365727466637577746B7A746564653571357475727773376364643577",\n   "raw_log":"[{\\"events\\":[{\\"type\\":\\"instantiate\\",\\"attributes\\":[{\\"key\\":\\"_contract_address\\",\\"value\\":\\"wasm12yguzqqgnv3jq0v4vta0dkfwvh8a43ertfcuwtkztede5q5turws7cdd5w\\"},{\\"key\\":\\"code_id\\",\\"value\\":\\"1268\\"}]},{\\"type\\":\\"message\\",\\"attributes\\":[{\\"key\\":\\"action\\",\\"value\\":\\"/cosmwasm.wasm.v1.MsgInstantiateContract\\"},{\\"key\\":\\"module\\",\\"value\\":\\"wasm\\"},{\\"key\\":\\"sender\\",\\"value\\":\\"wasm1t9jfuyv8xqas7j7pf4jrt7r4sq7s6epeatkz9y\\"}]}]}]",\n   "logs":[\n      {\n         "events":[\n            {\n               "type":"instantiate",\n               "attributes":[\n                  {\n                     "key":"_contract_address",\n                     "value":"wasm12yguzqqgnv3jq0v4vta0dkfwvh8a43ertfcuwtkztede5q5turws7cdd5w"\n                  },\n                  {\n                     "key":"code_id",\n                     "value":"1268"\n                  }\n               ]\n            },\n            {\n               "type":"message",\n               "attributes":[\n                  {\n                     "key":"action",\n                     "value":"/cosmwasm.wasm.v1.MsgInstantiateContract"\n                  },\n                  {\n                     "key":"module",\n                     "value":"wasm"\n                  },\n                  {\n                     "key":"sender",\n                     "value":"wasm1t9jfuyv8xqas7j7pf4jrt7r4sq7s6epeatkz9y"\n                  }\n               ]\n            }\n         ]\n      }\n   ],\n   "gas_wanted":"230828",\n   "gas_used":"192365"\n')),(0,s.kt)("p",null,"This command from before should now output the instantiated contract address."),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-sh"},"wasmd query wasm list-contract-by-code $CODE_ID --node https://rpc.malaga-420.cosmwasm.com:443 --output json\n")),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "contracts": [\n    "wasm12yguzqqgnv3jq0v4vta0dkfwvh8a43ertfcuwtkztede5q5turws7cdd5w"\n  ],\n  "pagination": {}\n}\n')),(0,s.kt)("p",null,"Now, we have a ready-to-use, instantiated contract. As you no doubt have observed, a lot of JSON manipulation is required to interact with smart contracts using ",(0,s.kt)("inlineCode",{parentName:"p"},"wasmd")," CLI. Luckily, we have a better option."),(0,s.kt)("h2",{id:"cosmjs"},"CosmJS"),(0,s.kt)("p",null,"CosmJS is the Swiss Army knife to power JavaScript based client solutions ranging from web-apps and block-explorers to server-side clients like faucets/scrapers in the Cosmos ecosystem. CosmJS contains all the functions you need to interact with Cosmos SDK clients. Making transactions, querying the blockchain and interacting with smart contracts can all be achieved using CosmJS."),(0,s.kt)("p",null,"For this tutorial, we will mainly explore the CosmWasm related capabilities of CosmJS."),(0,s.kt)("h3",{id:"setting-up-the-cosmjs-cli-client"},"Setting up the CosmJS CLI Client"),(0,s.kt)("p",null,"The first step should be to ensure that we can create an account and connect to the chain. You can always use the following command to start up the ",(0,s.kt)("inlineCode",{parentName:"p"},"@cosmjs/cli")," with some cw20-specific helpers preloaded\n(along with the generic ones)."),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-bash"},"npx @cosmjs/cli@^0.28.1 --init https://raw.githubusercontent.com/InterWasm/cw-plus-helpers/main/base.ts --init https://raw.githubusercontent.com/InterWasm/cw-plus-helpers/main/cw20-base.ts\n")),(0,s.kt)("p",null,"Now, the REPL client will be initialized."),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-js"},"const [addr, client] = await useOptions(malagaOptions).setup('password');\nclient.getAccount(addr);\n")),(0,s.kt)("p",null,"This will take a few seconds as credits are requested from the faucet, in order to ensure that you have some ",(0,s.kt)("inlineCode",{parentName:"p"},"umlg"),"s in your account to pay\nfees with. When it returns, the output should be similar to the one below:"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-json"},"{\n  address: 'wasm1w740h56j9nhudykkm80j5rf6ms25nhe9huuvgp',\n  pubkey: {\n    type: 'tendermint/PubKeySecp256k1',\n    value: 'AkjSrJA0XT612qHvnHieHAebZ+cIA2jq3LRj0g4V/lOF'\n  },\n  accountNumber: 323,\n  sequence: 4\n}\n")),(0,s.kt)("h3",{id:"reloading-your-wallet"},"Reloading your Wallet"),(0,s.kt)("p",null,"You can keep the current session active, or close and get back to it again some time later. As long as you run the following line with the same password, you can always use the same wallet address:"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-js"},'const [addr, client] = await useOptions(malagaOptions).setup("password");\n')),(0,s.kt)("p",null,(0,s.kt)("inlineCode",{parentName:"p"},"useOptions()")," with ",(0,s.kt)("inlineCode",{parentName:"p"},"malagaOptions")," passed in handles everything that we manually had to specify before, using the ",(0,s.kt)("inlineCode",{parentName:"p"},"wasmd")," CLI. When the function ",(0,s.kt)("inlineCode",{parentName:"p"},"setup")," is called with a password, it checks for the file ",(0,s.kt)("inlineCode",{parentName:"p"},"~/.malaga.key")," and loads the key from the file. In case the ",(0,s.kt)("inlineCode",{parentName:"p"},"~/.malaga.key")," file is missing, a new one is created to encrypt and store your randomly-generated private key (actually mnemonic). During future sessions, you will need to use the same password to gain access to your private key again. Try ",(0,s.kt)("inlineCode",{parentName:"p"},"cat ~/.malaga.key")," to prove yourself that it is indeed encrypted, or try running the line above with a different password and see how it fails."),(0,s.kt)("admonition",{type:"caution"},(0,s.kt)("p",{parentName:"admonition"},"The line above encrypts and stores the key in the ",(0,s.kt)("inlineCode",{parentName:"p"},"~/.malaga.key")," file. If you forget the password, either delete the ",(0,s.kt)("inlineCode",{parentName:"p"},"~/.malaga.key")," file or pass a ",(0,s.kt)("inlineCode",{parentName:"p"},"filename")," along with the password to create a new key as below:"),(0,s.kt)("pre",{parentName:"admonition"},(0,s.kt)("code",{parentName:"pre",className:"language-js"},'const [addr, client] = await useOptions(malagaOptions).setup("password","new_file_path_and_name");\n'))),(0,s.kt)("p",null,"If you want the mnemonic, you can recover it anytime, as long as you still have the ",(0,s.kt)("inlineCode",{parentName:"p"},"~/.malaga.key")," file and the correct password. This option can later be used to recover and use the same mnemonic to import the key into the ",(0,s.kt)("inlineCode",{parentName:"p"},"wasmd")," CLI."),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-js"},'useOptions(malagaOptions).recoverMnemonic("password");\n')),(0,s.kt)("p",null,"Now that you feel a bit more secure about your keys (and the ability to load them later), we can start interacting with smart contracts using CosmJS CLI."),(0,s.kt)("h3",{id:"example-star"},"Example: STAR"),(0,s.kt)("admonition",{type:"note"},(0,s.kt)("p",{parentName:"admonition"},"The example below is not meant to be copied verbatim, but to show how such a contract is set up and deployed the first time.")),(0,s.kt)("p",null,"If you haven't initialized one already, initialize a CosmJS CLI session with the following command:"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-bash"},"npx @cosmjs/cli@^0.28.1 --init https://raw.githubusercontent.com/InterWasm/cw-plus-helpers/main/base.ts --init https://raw.githubusercontent.com/InterWasm/cw-plus-helpers/main/cw20-base.ts \n")),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-js"},'//Generate a wallet address or load an existing one\nconst [addr, client] = await useOptions(malagaOptions).setup("password");\n\n//Create a new cw20 contract\nconst cw20 = CW20(client, malagaOptions);\n//Deploy the contract\nconst codeId = await cw20.upload(addr, malagaOptions);\n//Print the Code Id\nconsole.log(`CodeId: ${codeId}`);\n//Make sure to note the Code Id down, you will need it to interact with the binary later on\n\n//Enable REPL editor mode to edit multiple lines of code\n.editor\n//Define the cw20 instantiation message parameters\nconst initMsg = {\n  name: "Golden Stars",\n  symbol: "STAR",\n  decimals: 2,\n  // List of addresses with positive initial balance - 100 STARs each!\n  initial_balances: [\n    {address: "wasm13krn38qhu83y5xvmjgydnk5vjau2u3c0tv5jsu", amount: "10000"},\n    {address: "wasm1ppgpwep3yzh8w3d89xlzlens3420j5vs5q3p4j", amount: "10000"},\n    {address: "wasm1fnx5jzqsdkntlq2nspjgswtezf45u5ug3kq9sw", amount: "10000"},\n  ],\n  //Your wallet address has the minting rights\n  mint: {\n    minter: addr,\n  },\n};\n\n//Exit editor using `^D` to execute the code entered\n^D\n\nconst contract = await cw20.instantiate(addr, codeId, initMsg, "STAR", malagaOptions);\nconsole.log(`Contract: ${contract.contractAddress}`);\n// Contract: wasm1etfpx2smcwualafpld2mn2prnrc3yyed084a083g5p2vcht79n9qck6h55\n\n// Check the balance for one of the addresses with positive initial balance\nconsole.log(await contract.balance("wasm13krn38qhu83y5xvmjgydnk5vjau2u3c0tv5jsu"));\n// 10000\nconsole.log(await contract.tokenInfo());\n// {\n//   name: \'Golden Stars\',\n//   symbol: \'STAR\',\n//   decimals: 2,\n//   total_supply: \'30000\'\n// }\nconsole.log(await contract.minter());\n// Should output your wallet address\n\n// End the CosmJS CLI session\n.exit\n')),(0,s.kt)("h3",{id:"instantiating-a-new-contract"},"Instantiating a New Contract"),(0,s.kt)("p",null,"Now that the binary is uploaded and has a Code Id, we can easily instantiate a second contract. Again, please do go through the example below and feel free to customize the values before executing the code."),(0,s.kt)("p",null,"Initialize a new CosmJS CLI session with the following command:"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-bash"},"npx @cosmjs/cli@^0.28.1 --init https://raw.githubusercontent.com/InterWasm/cw-plus-helpers/main/base.ts --init https://raw.githubusercontent.com/InterWasm/cw-plus-helpers/main/cw20-base.ts \n")),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-js"},'//Generate a wallet address or load an existing one\nconst [addr, client] = await useOptions(malagaOptions).setup("password");\n//Create a new cw20 contract instance\nconst cw20 = CW20(client, malagaOptions);\n\n//Enable REPL editor mode to edit multiple lines of code\n.editor\n//Define the cw20 instantiation message parameters\nconst initMsg = {\n  name: "My Coin",\n  symbol: "MINE",\n  decimals: 6,\n  initial_balances: [\n    {address: addr, amount: "12345678000"},\n  ],\n  mint: {\n    minter: addr,\n    cap: "99900000000"\n  },\n};\n\n//Exit editor using `^D` to execute the code entered\n^D\n\n//Enter the Code Id for the binary you have uploaded previously\nconst codeId = 55;\n//Instantiate a new contract with the given Code Id and instantiation message parameters\nconst mine = await cw20.instantiate(addr, codeId, initMsg, "MINE", malagaOptions);\nconsole.log(`Contract: ${mine.contractAddress}`);\n// Contract: wasm1al2jl5kmhume74hdj6lspadmymz4attqpp9xuj6keqdgjwe9xalqlkle2h\n\n// Check the balance for your wallet address and make sure the contract is instantiated correctly\nmine.balance(addr);\n//\'12345678000\'\nmine.tokenInfo()\n// {\n//   name: \'My Coin\',\n//   symbol: \'MINE\',\n//   decimals: 6,\n//   total_supply: \'12345678000\'\n// }\nmine.minter()\n// {\n//   minter: <Your wallet address>,\n//   cap: \'99900000000\'\n// }\n\n//You may end the CosmJS CLI session for now.\n.exit\n')),(0,s.kt)("p",null,"We have successfully instantiated a second contract using the same Code Id. "),(0,s.kt)("p",null,"Now, it's time to go beyond instantiating a contract."),(0,s.kt)("h3",{id:"utilizing-contract-functions"},"Utilizing Contract Functions"),(0,s.kt)("p",null,"This section will focus on utilizing the query and execute functions provided by our newly constructed token."),(0,s.kt)("p",null,"Let's re-initialize the CosmJS CLI session first."),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-bash"},"npx @cosmjs/cli@^0.28.1 --init https://raw.githubusercontent.com/InterWasm/cw-plus-helpers/main/base.ts --init https://raw.githubusercontent.com/InterWasm/cw-plus-helpers/main/cw20-base.ts \n")),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-js"},"const [addr, client] = await useOptions(malagaOptions).setup(\"password\");\nconst cw20 = CW20(client, malagaOptions);\n\n// List of instantiated contracts with a given Code Id\n// You may pass in the Code Id you noted down earlier to get the list of contracts you instantiated\nconst contracts = await client.getContracts(55)\nconsole.log(contracts);\n// [\n//   'wasm1etfpx2smcwualafpld2mn2prnrc3yyed084a083g5p2vcht79n9qck6h55',\n//   'wasm1al2jl5kmhume74hdj6lspadmymz4attqpp9xuj6keqdgjwe9xalqlkle2h'\n// ]\n\n// Copy the address of your contract from the output above\nconst contractAddress = \"wasm1al2jl5kmhume74hdj6lspadmymz4attqpp9xuj6keqdgjwe9xalqlkle2h\"\n\n// Now, invoke the cw20.use() function to start utilizing contract functions \nconst mine = cw20.use(contractAddress);\n\n// Note that we haven't instantiated any new contracts. We are using the same contract that was instantiated previously.\nmine.balance(addr);\nmine.tokenInfo();\nmine.minter();\n")),(0,s.kt)("p",null,"Now that we are able to invoke contract functions, let us see what other capabilities a cw20 contract has. "),(0,s.kt)("p",null,"Since your wallet address was designated as a ",(0,s.kt)("em",{parentName:"p"},"minter"),", we can try minting tokens for an address. We can also try transferring tokens from our wallet address to other addresses."),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-js"},'// Define the addresses the tokens will be minted or transferred to\nconst some_address = "wasm1wrvhq03qww59ullrrmshajk3kqts83tqehc7ef";\nconst another_address = "wasm15e2fadm9lxgz4rtgglvsak3j5ec7uh2epphqd6";\n\n// Check the balances of the addresses before minting or transferring tokens\nmine.balance(addr)\nmine.balance(some_address)\nmine.balance(another_address)\n// The total amount of tokens\nmine.tokenInfo()\n\n// Minting some tokens for some_address_\nmine.mint(addr, some_address, "999888000")\n// The output should be the transaction hash, which can be carried over to https://block-explorer.malaga-420.cosmwasm.com/ to observe the details of the transaction\n// e.g., "07236649C79D259B8F4CEE81E789F4798D18D14C911F8E77D10474FCFFC0FE71"\n\n// See the updated balances\nmine.balance(some_address)\nmine.balance(addr)\n// Note that the total supply is increased, while the balance of the minter remains the same\nmine.tokenInfo()\n\n//Now, let us transfer some tokens instead of minting, before checking the balances again\nmine.transfer(addr, another_address, "4567000");\n// The output should be another transaction hash, which, again, can be carried over to https://block-explorer.malaga-420.cosmwasm.com/ to observe the details of the transaction\n// e.g., "434FF36D79E2D92F0F29E38C478DD75F6829AB0E9EFE274218250E7EC9F7CD4C"\n\n// See the updated balances\nmine.balance(another_address)\nmine.balance(addr)\n//Note that the total supply hasn\'t changed\nmine.tokenInfo()\n')),(0,s.kt)("p",null,"With that, we have covered some of the main capabilities of a cw20 contract and learned how to utilize them."))}m.isMDXComponent=!0}}]);