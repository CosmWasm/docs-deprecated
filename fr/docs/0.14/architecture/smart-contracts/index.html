<!doctype html>
<html class="docs-version-0.14" lang="fr" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.9">
<link rel="search" type="application/opensearchdescription+xml" title="CosmWasm Documentation" href="/fr/opensearch.xml"><title data-react-helmet="true">Comparison with Solidity Contracts | CosmWasm Documentation</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://docs.cosmwasm.com/fr/docs/0.14/architecture/smart-contracts"><meta data-react-helmet="true" name="docsearch:language" content="fr"><meta data-react-helmet="true" name="docsearch:version" content="0.14"><meta data-react-helmet="true" name="docsearch:docusaurus_tag" content="docs-docs-0.14"><meta data-react-helmet="true" property="og:title" content="Comparison with Solidity Contracts | CosmWasm Documentation"><meta data-react-helmet="true" name="description" content="First of all, the deploy-execute process consists of 3 steps rather than 2. While Ethereum was built around the concept"><meta data-react-helmet="true" property="og:description" content="First of all, the deploy-execute process consists of 3 steps rather than 2. While Ethereum was built around the concept"><link data-react-helmet="true" rel="shortcut icon" href="/fr/img/favicon.svg"><link data-react-helmet="true" rel="canonical" href="https://docs.cosmwasm.com/fr/docs/0.14/architecture/smart-contracts"><link data-react-helmet="true" rel="alternate" href="https://docs.cosmwasm.com/docs/0.14/architecture/smart-contracts" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://docs.cosmwasm.com/fr/docs/0.14/architecture/smart-contracts" hreflang="fr"><link data-react-helmet="true" rel="alternate" href="https://docs.cosmwasm.com/docs/0.14/architecture/smart-contracts" hreflang="x-default"><link data-react-helmet="true" rel="preconnect" href="https://BH4D9OD16A-dsn.algolia.net" crossorigin="anonymous"><link rel="stylesheet" href="/fr/assets/css/styles.83b192da.css">
<link rel="preload" href="/fr/assets/js/runtime~main.739ab344.js" as="script">
<link rel="preload" href="/fr/assets/js/main.17395a17.js" as="script">
</head>
<body>
<script>!function(){function e(e){document.documentElement.setAttribute("data-theme",e)}var t=function(){var e=null;try{e=localStorage.getItem("theme")}catch(e){}return e}();null!==t?e(t):window.matchMedia("(prefers-color-scheme: dark)").matches?e("dark"):window.matchMedia("(prefers-color-scheme: light)").matches?e("light"):e("dark")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_OuoZ">Skip to main content</a></div><nav class="navbar navbar--fixed-top navbarHideable_RReh"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a href="https://docs.cosmwasm.com/" target="_blank" rel="noopener noreferrer" class="navbar__brand"><div class="navbar__logo"><img src="/fr/img/logo.svg" alt="CosmWasm" class="themedImage_TMUO themedImage--light_4Vu1"><img src="/fr/img/logo_dark.svg" alt="CosmWasm" class="themedImage_TMUO themedImage--dark_uzRr"></div></a><a class="navbar__item navbar__link navbar__link--active" href="/fr/docs/0.14/">Docs</a><div class="navbar__item dropdown dropdown--hoverable"><a class="navbar__link">Learn</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/fr/dev-academy/intro">Dev Academy</a></li><li><a class="dropdown__link" href="/fr/tutorials/hijack-escrow/intro">Tutorials</a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable"><a class="navbar__link">dApps</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/fr/cw-plus/0.9.0/overview">cw-plus</a></li></ul></div><a class="navbar__item navbar__link" href="/fr/ecosystem/overview">Ecosystem</a></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a class="navbar__link" href="/fr/docs/0.14/">0.14</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/fr/docs/1.0/architecture/smart-contracts">1.0</a></li><li><a class="dropdown__link" href="/fr/docs/0.16/architecture/smart-contracts">0.16</a></li><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/fr/docs/0.14/architecture/smart-contracts">0.14</a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" class="navbar__link"><span><svg viewBox="0 0 20 20" width="20" height="20" aria-hidden="true" class="iconLanguage_EbrZ"><path fill="currentColor" d="M19.753 10.909c-.624-1.707-2.366-2.726-4.661-2.726-.09 0-.176.002-.262.006l-.016-2.063 3.525-.607c.115-.019.133-.119.109-.231-.023-.111-.167-.883-.188-.976-.027-.131-.102-.127-.207-.109-.104.018-3.25.461-3.25.461l-.013-2.078c-.001-.125-.069-.158-.194-.156l-1.025.016c-.105.002-.164.049-.162.148l.033 2.307s-3.061.527-3.144.543c-.084.014-.17.053-.151.143.019.09.19 1.094.208 1.172.018.08.072.129.188.107l2.924-.504.035 2.018c-1.077.281-1.801.824-2.256 1.303-.768.807-1.207 1.887-1.207 2.963 0 1.586.971 2.529 2.328 2.695 3.162.387 5.119-3.06 5.769-4.715 1.097 1.506.256 4.354-2.094 5.98-.043.029-.098.129-.033.207l.619.756c.08.096.206.059.256.023 2.51-1.73 3.661-4.515 2.869-6.683zm-7.386 3.188c-.966-.121-.944-.914-.944-1.453 0-.773.327-1.58.876-2.156a3.21 3.21 0 011.229-.799l.082 4.277a2.773 2.773 0 01-1.243.131zm2.427-.553l.046-4.109c.084-.004.166-.01.252-.01.773 0 1.494.145 1.885.361.391.217-1.023 2.713-2.183 3.758zm-8.95-7.668a.196.196 0 00-.196-.145h-1.95a.194.194 0 00-.194.144L.008 16.916c-.017.051-.011.076.062.076h1.733c.075 0 .099-.023.114-.072l1.008-3.318h3.496l1.008 3.318c.016.049.039.072.113.072h1.734c.072 0 .078-.025.062-.076-.014-.05-3.083-9.741-3.494-11.04zm-2.618 6.318l1.447-5.25 1.447 5.25H3.226z"></path></svg><span>fran√ßais</span></span></a><ul class="dropdown__menu"><li><a href="/docs/0.14/architecture/smart-contracts" target="_self" rel="noopener noreferrer" class="dropdown__link" style="text-transform:capitalize">English</a></li><li><a href="/fr/docs/0.14/architecture/smart-contracts" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active" style="text-transform:capitalize">fran√ßais</a></li></ul></div><div class="toggle_iYfV toggle_2i4l toggleChecked_a04y toggleDisabled_xj38"><div class="toggleTrack_t-f2" role="button" tabindex="-1"><div class="toggleTrackCheck_mk7D"><span class="toggleIcon_pHJ9">üåú</span></div><div class="toggleTrackX_dm8H"><span class="toggleIcon_pHJ9">üåû</span></div><div class="toggleTrackThumb_W6To"></div></div><input type="checkbox" checked="" class="toggleScreenReader_h9qa" aria-label="Switch between dark and light mode"></div><div class="searchBox_NKBi"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_lDyR"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_i9tI" type="button"></button><aside class="docSidebarContainer_0YBq"><div class="sidebar_a3j0 sidebarWithHideableNavbar_VlPv"><a href="https://docs.cosmwasm.com/" target="_blank" rel="noopener noreferrer" tabindex="-1" class="sidebarLogo_hmkv"><img src="/fr/img/logo.svg" alt="CosmWasm" class="themedImage_TMUO themedImage--light_4Vu1"><img src="/fr/img/logo_dark.svg" alt="CosmWasm" class="themedImage_TMUO themedImage--dark_uzRr"></a><nav class="menu thin-scrollbar menu_cyFh"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/fr/docs/0.14/">Introduction</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><a class="menu__link menu__link--sublist" href="#">Getting Started</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/fr/docs/0.14/getting-started/intro">Your First Contract</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/fr/docs/0.14/getting-started/installation">Installation</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/fr/docs/0.14/getting-started/setting-env">Setting Up Environment</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/fr/docs/0.14/getting-started/compile-contract">Downloading and Compiling Contract</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/fr/docs/0.14/getting-started/interact-with-contract">Uploading and Interacting</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/fr/docs/0.14/getting-started/next-steps">Next Steps</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#">Architecture</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/fr/docs/0.14/architecture/multichain">What are Multi-Chain Contracts?</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/fr/docs/0.14/architecture/actor">Actor Model</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/fr/docs/0.14/architecture/addresses">Names and Addresses</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/fr/docs/0.14/architecture/query">Querying</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/fr/docs/0.14/architecture/serialization">Serialization</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/fr/docs/0.14/architecture/composition">Contract Composition</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/fr/docs/0.14/architecture/smart-contracts">Comparison with Solidity Contracts</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">IBC</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/fr/docs/0.14/COMPATIBILITY">Compatibility</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/fr/docs/0.14/MIGRATING">Migrating Contracts</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/fr/docs/0.14/CHANGELOG">CHANGELOG</a></li></ul></nav><button type="button" title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_eoK2"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_e+kA"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></aside><main class="docMainContainer_r8cw"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_zHA2"><div class="theme-doc-version-banner alert alert--warning margin-bottom--md" role="alert"><div>This is documentation for <!-- -->CosmWasm Documentation<!-- --> <b>0.14</b>, which is no longer actively maintained.</div><div class="margin-top--md">For up-to-date documentation, see the <b><a href="/fr/docs/1.0/architecture/smart-contracts">latest version</a></b> (<!-- -->1.0<!-- -->).</div></div><div class="docItemContainer_oiyr"><article><span class="theme-doc-version-badge badge badge--secondary">Version: <!-- -->0.14</span><div class="tocCollapsible_aw-L theme-doc-toc-mobile tocMobile_Tx6Y"><button type="button" class="clean-btn tocCollapsibleButton_zr6a">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Comparison with Solidity Contracts</h1></header><p>First of all, the deploy-execute process consists of 3 steps rather than 2. While Ethereum was built around the concept
of many unique contracts, each possibly custom-made for any bilateral agreement, the reality seems to show that writing
a bug-free contract is harder than originally thought, and a majority are copies of standard templates like
OpenZepellin. With that in mind, and conscious of the overhead of uploading and validating wasm code, we define the
following 3 phases of a contract:</p><ul><li>Upload Code - Upload some optimized wasm code, no state nor contract address (example Standard ERC20 contract)</li><li>Instantiate Contract - Instantiate a code reference with some initial state, creates new address (example set token
name, max issuance, etc for <em>my</em> ERC20 token)</li><li>Execute Contract - This may support many different calls, but they are all unprivileged usage of a previously
instantiated contract, depends on the contract design (example: Send ERC20 token, grant approval to other contract)</li></ul><p>Just like ethereum, contract instantiation and execution is metered and requires gas. Furthermore, both instantiation
and execution allow the signer to send some tokens to the contract along with the message. Two key differences are that
sending tokens directly to a contract, eg. via <code>SendMsg</code>, while possible, <em>does not trigger any contract code</em>. This is
a clear design decision to reduce possible attack vectors. It doesn&#x27;t make anything impossible, but requires all
execution of the contract to be <em>explicitly requested</em>.</p><h2 class="anchor anchorWithHideOnScrollNavbar_3ly5" id="avoiding-reentrancy-attacks">Avoiding Reentrancy Attacks<a aria-hidden="true" class="hash-link" href="#avoiding-reentrancy-attacks" title="Direct link to heading">‚Äã</a></h2><p>Another big difference is that we avoid all reentrancy attacks by design. This point deserves an article by itself, but
in
short <a href="https://consensys.github.io/smart-contract-best-practices/known_attacks/" target="_blank" rel="noopener noreferrer">a large class of exploits in Ethereum is based on this trick</a>
. The idea is that in the middle of execution of a function on Contract A, it calls a second contract (explicitly or
implicitly via send). This transfers control to contract B, which can now execute code, and call into Contract A again.
Now there are two copies of Contract A running, and unless you are very, very careful about managing state before
executing any remote contract or make very strict gas limits in sub-calls, this can trigger undefined behavior in
Contract A, and a clever hacker can reentrancy this as a basis for exploits, such as the DAO hack.</p><p>Cosmwasm avoids this completely by preventing any contract from calling another one directly. Clearly we want to allow
composition, but inline function calls to malicious code creates a security nightmare. The approach taken with CosmWasm
is to allow any contract to <em>return</em> a list of messages <em>to be executed in the same transaction</em>. This means that a
contract can request a send to happen after it is finished (eg. release escrow), or call into other contract. If the
future messages fail, then the entire transaction reverts, including updates to the contract&#x27;s state. This allows to
atomic composition and quite a few security guarantees, with the only real downside that you cannot view the results of
executing another contract, rather you can just do &quot;revert on error&quot;.</p><p>Sometimes we will need information from another contract, and with the 0.8 release, we added synchronous queries to
other contracts or underlying Cosmos SDK modules. These Queries only have access to a read-only database snapshot and be
unable to modify state or send messages to other modules, thus avoiding any possible reentrancy concerns.</p><h2 class="anchor anchorWithHideOnScrollNavbar_3ly5" id="resource-limits">Resource Limits<a aria-hidden="true" class="hash-link" href="#resource-limits" title="Direct link to heading">‚Äã</a></h2><p>Beyond exploits (such as the reentrancy attack), another attack vector for smart contracts is denial of service attacks.
A malicious actor could upload a contract that ran an infinite loop to halt the chain or write tons of data to fill up
the disk. Web Assembly provides a tight sandbox with no default access to the OS, so we only need to worry about
providing tight resource limits for the smart contracts. All developers should be aware of these limits.</p><p><em>Memory Usage</em> - When instantiating a Wasm VM, it is provided by 32MB of RAM by default. This is to store the byte code
as well as all memory used by running the process (stack and heap). This should be plenty large for almost any contract,
but maybe some complex zero knowledge circuits would hit limits there. It is also small enough to ensure that contracts
have minimal impact of memory usage of the blockchain.</p><p><em>CPU Usage</em> - The <a href="https://github.com/wasmerio/wasmer" target="_blank" rel="noopener noreferrer">Wasmer Runtime</a> that we use, has ability to inject metering logic
into the wasm code. It calculates prices for various operations and charges and checks limits before every jump
statement (loop, function call, etc), to produce a deterministic gas price regardless of cpu speed, platform, etc.
Before executing a contract, a wasm gas limit is set based on remaining Cosmos SDK gas, and gas deducted at the end of
the contract (there is a constant multiplier to convert, currently 100 wasm gas to 1 sdk gas). This puts a hard limit on
any CPU computations as you must pay for the cycles used.</p><p><em>Disk Usage</em> - All disk access is via reads and writes on the KVStore. The Cosmos SDK
already <a href="https://github.com/cosmos/cosmos-sdk/blob/4ffabb65a5c07dbb7010da397535d10927d298c1/store/types/gas.go#L154-L162" target="_blank" rel="noopener noreferrer">enforces gas payments for KVStore access</a>
. Since all disk access in the contracts is made via callbacks into the SDK, this is charged there. If one were to
integrate CosmWasm in another runtime, you would have to make sure to charge for access there as well.</p><h2 class="anchor anchorWithHideOnScrollNavbar_3ly5" id="lessons-learned-from-ethereum">Lessons Learned from Ethereum<a aria-hidden="true" class="hash-link" href="#lessons-learned-from-ethereum" title="Direct link to heading">‚Äã</a></h2><p>Ethereum is the grandfather of all blockchain smart contract platforms and has far more usage and real world experience
than any other platform. We cannot discount this knowledge, but instead learn from their successes and failures to
produce a more robust smart contract platform.</p><p>They have compiled a list of <a href="https://github.com/sigp/solidity-security-blog" target="_blank" rel="noopener noreferrer">all known ethereum attack vectors</a> along
with mitigation strategies. We shall compare Cosmwasm against this list to see how much of this applies here. Many of
these attack vectors are closed by design. A number remain and a section is planned on avoiding the remaining such
issues.</p><h3 class="anchor anchorWithHideOnScrollNavbar_3ly5" id="heavy_check_mark-reentrancy">‚úîÔ∏è <a href="https://github.com/sigp/solidity-security-blog#reentrancy" target="_blank" rel="noopener noreferrer">Reentrancy</a><a aria-hidden="true" class="hash-link" href="#heavy_check_mark-reentrancy" title="Direct link to heading">‚Äã</a></h3><p>In cosmwasm, we return messages to execute other contracts, in the same atomic operation, but <em>after</em> the contract has
finished. This is based on the actor model and avoid the possibility of reentrancy attacks - there is never volatile
state when a contract is called.</p><h3 class="anchor anchorWithHideOnScrollNavbar_3ly5" id="heavy_check_mark-arithmetic-underoverflows">‚úîÔ∏è <a href="https://github.com/sigp/solidity-security-blog#ouflow" target="_blank" rel="noopener noreferrer">Arithmetic under/overflows</a><a aria-hidden="true" class="hash-link" href="#heavy_check_mark-arithmetic-underoverflows" title="Direct link to heading">‚Äã</a></h3><p>Rust allows you to simply set <code>overflow-checks = true</code> in
the <a href="https://doc.rust-lang.org/cargo/reference/manifest.html#the-profile-sections" target="_blank" rel="noopener noreferrer">Cargo manifest</a> to abort the program
if any overflow is detected. No way to opt-out of safe math.</p><h3 class="anchor anchorWithHideOnScrollNavbar_3ly5" id="warning-unexpected-ether">‚ö†Ô∏è <a href="https://github.com/sigp/solidity-security-blog#ether" target="_blank" rel="noopener noreferrer">Unexpected Ether</a><a aria-hidden="true" class="hash-link" href="#warning-unexpected-ether" title="Direct link to heading">‚Äã</a></h3><p><strong>Bad design pattern</strong></p><p>This involves a contract depending on complete control of it&#x27;s balance. A design pattern that should be avoided in any
contract system. In CosmWasm, contracts are not called when tokens are sent to them, but they can query their current
balance when they are called. You can note that
the <a href="https://github.com/CosmWasm/cw-examples/blob/escrow-0.4.0/escrow/src/contract.rs" target="_blank" rel="noopener noreferrer">sample escrow contract</a>
doesn&#x27;t record how much was sent to it during initialization, but
rather <a href="https://github.com/CosmWasm/cw-examples/blob/escrow-0.4.0/escrow/src/contract.rs#L83-L92" target="_blank" rel="noopener noreferrer">releases the current balance</a>
when a paying out or refunding the amount. This ensures no tokens get stuck.</p><h3 class="anchor anchorWithHideOnScrollNavbar_3ly5" id="heavy_check_mark-delegate-call">‚úîÔ∏è <a href="https://github.com/sigp/solidity-security-blog#delegatecall" target="_blank" rel="noopener noreferrer">Delegate Call</a><a aria-hidden="true" class="hash-link" href="#heavy_check_mark-delegate-call" title="Direct link to heading">‚Äã</a></h3><p>We don&#x27;t have such Delegate Call logic in CosmWasm. You can import modules, but they are linked together at compile
time, which allows them to be tested as a whole, and no subtle entry points inside of a contract&#x27;s logic.</p><h3 class="anchor anchorWithHideOnScrollNavbar_3ly5" id="heavy_check_mark-default-visibilities">‚úîÔ∏è <a href="https://github.com/sigp/solidity-security-blog#visibility" target="_blank" rel="noopener noreferrer">Default Visibilities</a><a aria-hidden="true" class="hash-link" href="#heavy_check_mark-default-visibilities" title="Direct link to heading">‚Äã</a></h3><p>Rather than auto-generating entry points for every function/method in your code (and worse yet, assuming public if not
specified), the developer must clearly define a list of messages to be handled and dispatch them to the proper
functions. It is impossible to accidentally expose a function this way.</p><h3 class="anchor anchorWithHideOnScrollNavbar_3ly5" id="warning-entropy-illusion">‚ö†Ô∏è <a href="https://github.com/sigp/solidity-security-blog#entropy" target="_blank" rel="noopener noreferrer">Entropy Illusion</a><a aria-hidden="true" class="hash-link" href="#warning-entropy-illusion" title="Direct link to heading">‚Äã</a></h3><p><strong>Planned Fix</strong></p><p>The block hashes (and last digits of timestamps) are even more easily manipulated by block proposers in Tendermint, than
with miners in Ethereum. They should definitely not be used for randomness. There is work planned to provide a secure
random beacon, and expose this secure source of entropy to smart contracts.</p><h3 class="anchor anchorWithHideOnScrollNavbar_3ly5" id="heavy_check_mark-external-contract-referencing">‚úîÔ∏è <a href="https://github.com/sigp/solidity-security-blog#contract-reference" target="_blank" rel="noopener noreferrer">External Contract Referencing</a><a aria-hidden="true" class="hash-link" href="#heavy_check_mark-external-contract-referencing" title="Direct link to heading">‚Äã</a></h3><p><strong>Planned Mitigation</strong></p><p>If you call a contract with a given <code>HandleMsg</code>, this just requires the contract has the specified API, but says nothing
of the code there. I could upload malicious code with the same API as a desired contract (or a superset of the API), and
ask you to call it - either directly or from a contract. This can be used to steal funds, and in fact
we <a href="/fr/tutorials/hijack-escrow/hack-contract">demo this in the tutorial</a>.</p><p>There are two mitigations here. The first is that in CosmWasm, you don&#x27;t need to call out to solidity libraries at
runtime to deal with size limits, but are encouraged to link all the needed code into one wasm blob. This alone removes
most usage of the external contract references.</p><p>The other mitigation is allowing users to quickly find verified rust source behind the wasm contract on the chain. This
approach is <a href="https://medium.com/coinmonks/how-to-verify-and-publish-on-etherscan-52cf25312945#bc72" target="_blank" rel="noopener noreferrer">used by etherscan</a>,
where developers can publish the original source code, and it will compile the code. If the same bytecode is on chain,
we know can prove it came from this rust source. We have built the deterministic build system for rust wasm, and
have <a href="https://medium.com/confio/dont-trust-cosmwasm-verify-db1caac2d335" target="_blank" rel="noopener noreferrer">simple tooling to validate the original source code</a>
. We also <a href="https://demonet.wasm.glass/codes" target="_blank" rel="noopener noreferrer">released a code explorer</a> that allows you to browse contracts and locally
verify the source code in one command.</p><h3 class="anchor anchorWithHideOnScrollNavbar_3ly5" id="heavy_check_mark-short-addressparameter-attack">‚úîÔ∏è <a href="https://github.com/sigp/solidity-security-blog#short-address" target="_blank" rel="noopener noreferrer">Short Address/Parameter Attack</a><a aria-hidden="true" class="hash-link" href="#heavy_check_mark-short-addressparameter-attack" title="Direct link to heading">‚Äã</a></h3><p>This is an exploit that takes advantage of the RLP encoding mechanism and fixed 32-byte stack size. It does not apply to
our type-checking json parser.</p><h3 class="anchor anchorWithHideOnScrollNavbar_3ly5" id="heavy_check_mark-unchecked-call-return-values">‚úîÔ∏è <a href="https://github.com/sigp/solidity-security-blog#unchecked-calls" target="_blank" rel="noopener noreferrer">Unchecked CALL Return Values</a><a aria-hidden="true" class="hash-link" href="#heavy_check_mark-unchecked-call-return-values" title="Direct link to heading">‚Äã</a></h3><p>CosmWasm does not allow calling other contracts directly, but rather returning message to later be dispatched by a
router. The router will check the result of all messages, and if <strong>any</strong> message in the chain returns an error, the
entire transaction is aborted, and state changed rolled back. This allows you to safely focus on the success case when
scheduling calls to other contracts, knowing all state will be rolled back if it does not go as planned.</p><h3 class="anchor anchorWithHideOnScrollNavbar_3ly5" id="warning-race-conditionsfront-running">‚ö†Ô∏è <a href="https://github.com/sigp/solidity-security-blog#race-conditions" target="_blank" rel="noopener noreferrer">Race Conditions/Front Running</a><a aria-hidden="true" class="hash-link" href="#warning-race-conditionsfront-running" title="Direct link to heading">‚Äã</a></h3><p>This is a general problem with all blockchains. The signed message is gossiped among all nodes before a block is formed.
A key miner/validator could create another transaction and insert it before yours (maybe delaying yours). This is often
not an issue, but shows up quite a bit in distributed exchanges. If there is a standing sell order at 90 and I place a
buy order at 100, it would normally just match at 90. However, a miner could insert two transactions between, one to buy
at 90, then other to sell at 100, then delay your transaction to the end. You would end up accepting their offer at 100
and they would make a profit of 10 tokens just for doing arbitrage.</p><p>This is also an issue in high-frequency trading and any system that relies on ordering between clients to determine the
outcome, just more pronounced in blockchain as the delays are on the order of seconds, not microseconds. For most
applications this is not an issue, and for decentralized exchanges, there are designs with eg. batch auctions that
eliminate the potential of front running.</p><h3 class="anchor anchorWithHideOnScrollNavbar_3ly5" id="warning-denial-of-service">‚ö†Ô∏è <a href="https://github.com/sigp/solidity-security-blog#dos" target="_blank" rel="noopener noreferrer">Denial of Service</a><a aria-hidden="true" class="hash-link" href="#warning-denial-of-service" title="Direct link to heading">‚Äã</a></h3><p><strong>limited circumstances</strong></p><p>The idea is that if the contract relies on some external user-defined input, it could be set up in a way that it would
run out of gas processing it. Many of the cases there should not effect CosmWasm, especially as wasm runs much faster
and cpu gas limits allow huge amounts of processing in one transaction (including ed25519 signature verification in wasm
without a precompile). However, looping over an user-controlled number of keys in the storage will run out of gas
quickly.</p><h3 class="anchor anchorWithHideOnScrollNavbar_3ly5" id="heavy_check_mark-block-timestamp-manipulation">‚úîÔ∏è <a href="https://github.com/sigp/solidity-security-blog#block-timestamp" target="_blank" rel="noopener noreferrer">Block Timestamp Manipulation</a><a aria-hidden="true" class="hash-link" href="#heavy_check_mark-block-timestamp-manipulation" title="Direct link to heading">‚Äã</a></h3><p>Tendermint
provides <a href="https://github.com/tendermint/tendermint/blob/master/docs/spec/blockchain/blockchain.md#time-1" target="_blank" rel="noopener noreferrer">BFT Timestamps</a>
in all the blockchain headers. This means that you need a majority of the validators to collude to manipulate the
timestamp, and it can be as trusted as the blockchain itself. (That same majority could halt the chain or work on a
fork)</p><h3 class="anchor anchorWithHideOnScrollNavbar_3ly5" id="heavy_check_mark-constructors-with-care">‚úîÔ∏è <a href="https://github.com/sigp/solidity-security-blog#constructors" target="_blank" rel="noopener noreferrer">Constructors with Care</a><a aria-hidden="true" class="hash-link" href="#heavy_check_mark-constructors-with-care" title="Direct link to heading">‚Äã</a></h3><p>This is an idiosyncrasy of the solidity language with constructor naming. It is highly unlikely you would ever
rename <code>init</code> in cosmwasm, and if you did, it would fail to compile rather than producing a backdoor.</p><h3 class="anchor anchorWithHideOnScrollNavbar_3ly5" id="heavy_check_mark-uninitialised-storage-pointers">‚úîÔ∏è <a href="https://github.com/sigp/solidity-security-blog#storage" target="_blank" rel="noopener noreferrer">Uninitialised Storage Pointers</a><a aria-hidden="true" class="hash-link" href="#heavy_check_mark-uninitialised-storage-pointers" title="Direct link to heading">‚Äã</a></h3><p>CosmWasm doesn&#x27;t automatically fill in variables, you must explicitly load them from storage. And rust does not allow
uninitialized variables anywhere (unless you start writing <code>unsafe</code> blocks, and make a special call to access
uninitialized memory... but then you are asking for trouble). Making storage explicit rather than implicit removes this
class of failures.</p><h3 class="anchor anchorWithHideOnScrollNavbar_3ly5" id="heavy_check_mark-floating-points-and-precision">‚úîÔ∏è <a href="https://github.com/sigp/solidity-security-blog#precision" target="_blank" rel="noopener noreferrer">Floating Points and Precision</a><a aria-hidden="true" class="hash-link" href="#heavy_check_mark-floating-points-and-precision" title="Direct link to heading">‚Äã</a></h3><p>Both Solidity and CosmWasm have no support for floating point operations, due to possible non-determinism in rounding (
which is CPU dependent). Solidity has no alternative to do integer math and many devs hand-roll integer approximations
to decimal numbers, which may introduce rounding errors.</p><p>In CosmWasm, You can import any rust package, and simply pick an appropriate package and use it internally.
Like <a href="https://docs.rs/rust_decimal/1.0.3/rust_decimal/" target="_blank" rel="noopener noreferrer">rust_decimal</a>, &quot;a Decimal implementation written in pure Rust
suitable for financial calculations that require significant integral and fractional digits with no round-off errors.&quot;.
Or <a href="https://docs.rs/fixed/0.5.0/fixed/" target="_blank" rel="noopener noreferrer">fixed</a> to provide fixed-point decimal math. It supports up to 128-bit numbers,
which is enough for 18 digits before the decimal and 18 afterwards, which should be enough for any use case.</p><h3 class="anchor anchorWithHideOnScrollNavbar_3ly5" id="heavy_check_mark-txorigin-authentication">‚úîÔ∏è <a href="https://github.com/sigp/solidity-security-blog#tx-origin" target="_blank" rel="noopener noreferrer">Tx.Origin Authentication</a><a aria-hidden="true" class="hash-link" href="#heavy_check_mark-txorigin-authentication" title="Direct link to heading">‚Äã</a></h3><p>CosmWasm doesn&#x27;t expose <code>tx.origin</code>, but only the contract or user directly calling the contract
as <code>params.message.signer</code>. This means it is impossible to rely on the wrong authentication, as there is only one value
to compare.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/InterWasm/docs/edit/main/docs_versioned_docs/version-0.14/03-architecture/07-smart-contracts.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_mS5F" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_mt2f"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/fr/docs/0.14/architecture/composition"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">¬´ <!-- -->Contract Composition</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/fr/docs/0.14/ibc/overview"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">IBC And CosmWasm<!-- --> ¬ª</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_vrFS thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#avoiding-reentrancy-attacks" class="table-of-contents__link toc-highlight">Avoiding Reentrancy Attacks</a></li><li><a href="#resource-limits" class="table-of-contents__link toc-highlight">Resource Limits</a></li><li><a href="#lessons-learned-from-ethereum" class="table-of-contents__link toc-highlight">Lessons Learned from Ethereum</a><ul><li><a href="#heavy_check_mark-reentrancy" class="table-of-contents__link toc-highlight">‚úîÔ∏è Reentrancy</a></li><li><a href="#heavy_check_mark-arithmetic-underoverflows" class="table-of-contents__link toc-highlight">‚úîÔ∏è Arithmetic under/overflows</a></li><li><a href="#warning-unexpected-ether" class="table-of-contents__link toc-highlight">‚ö†Ô∏è Unexpected Ether</a></li><li><a href="#heavy_check_mark-delegate-call" class="table-of-contents__link toc-highlight">‚úîÔ∏è Delegate Call</a></li><li><a href="#heavy_check_mark-default-visibilities" class="table-of-contents__link toc-highlight">‚úîÔ∏è Default Visibilities</a></li><li><a href="#warning-entropy-illusion" class="table-of-contents__link toc-highlight">‚ö†Ô∏è Entropy Illusion</a></li><li><a href="#heavy_check_mark-external-contract-referencing" class="table-of-contents__link toc-highlight">‚úîÔ∏è External Contract Referencing</a></li><li><a href="#heavy_check_mark-short-addressparameter-attack" class="table-of-contents__link toc-highlight">‚úîÔ∏è Short Address/Parameter Attack</a></li><li><a href="#heavy_check_mark-unchecked-call-return-values" class="table-of-contents__link toc-highlight">‚úîÔ∏è Unchecked CALL Return Values</a></li><li><a href="#warning-race-conditionsfront-running" class="table-of-contents__link toc-highlight">‚ö†Ô∏è Race Conditions/Front Running</a></li><li><a href="#warning-denial-of-service" class="table-of-contents__link toc-highlight">‚ö†Ô∏è Denial of Service</a></li><li><a href="#heavy_check_mark-block-timestamp-manipulation" class="table-of-contents__link toc-highlight">‚úîÔ∏è Block Timestamp Manipulation</a></li><li><a href="#heavy_check_mark-constructors-with-care" class="table-of-contents__link toc-highlight">‚úîÔ∏è Constructors with Care</a></li><li><a href="#heavy_check_mark-uninitialised-storage-pointers" class="table-of-contents__link toc-highlight">‚úîÔ∏è Uninitialised Storage Pointers</a></li><li><a href="#heavy_check_mark-floating-points-and-precision" class="table-of-contents__link toc-highlight">‚úîÔ∏è Floating Points and Precision</a></li><li><a href="#heavy_check_mark-txorigin-authentication" class="table-of-contents__link toc-highlight">‚úîÔ∏è Tx.Origin Authentication</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Related Documentation</div><ul class="footer__items"><li class="footer__item"><a href="https://cosmos.network/docs" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Cosmos SDK<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://hub.cosmos.network/" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Cosmos Hub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://docs.tendermint.com/" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Tendermint Core<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div><div class="col footer__col"><div class="footer__title">Repositories</div><ul class="footer__items"><li class="footer__item"><a href="https://github.com/CosmWasm/cosmwasm" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>CosmWasm/cosmwasm<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://github.com/CosmWasm/wasmd" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>CosmWasm/wasmd<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://github.com/CosmWasm/cw-plus" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>CosmWasm/cw-plus<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://github.com/InterWasm/cw-contracts" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>InterWasm/cw-contracts<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://github.com/InterWasm/cw-awesome" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>InterWasm/cw-awesome<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items"><li class="footer__item"><a href="https://medium.com/cosmwasm" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Blog<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://docs.cosmwasm.com/chat/" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://twitter.com/CosmWasm" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://github.com/InterWasm" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>InterWasm<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div></div><div class="footer__bottom text--center"><div class="margin-bottom--sm"><a href="https://cosmwasm.com" target="_blank" rel="noopener noreferrer" class="footerLogoLink_SRtH"><img src="/fr/img/logo_stacked.png" alt="CosmWasm Logo" class="themedImage_TMUO themedImage--light_4Vu1 footer__logo"><img src="/fr/img/logo_stacked.png" alt="CosmWasm Logo" class="themedImage_TMUO themedImage--dark_uzRr footer__logo"></a></div><div class="footer__copyright">Copyright ¬© 2021 CosmWasm</div></div></div></footer></div>
<script src="/fr/assets/js/runtime~main.739ab344.js"></script>
<script src="/fr/assets/js/main.17395a17.js"></script>
</body>
</html>