(self.webpackChunkc=self.webpackChunkc||[]).push([[3561],{3905:function(e,t,r){"use strict";r.d(t,{Zo:function(){return u},kt:function(){return m}});var n=r(7294);function o(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function a(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function i(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?a(Object(r),!0).forEach((function(t){o(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):a(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function s(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r,n,o={},a=Object.keys(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||(o[r]=e[r]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}var c=n.createContext({}),l=function(e){var t=n.useContext(c),r=t;return e&&(r="function"==typeof e?e(t):i(i({},t),e)),r},u=function(e){var t=l(e.components);return n.createElement(c.Provider,{value:t},e.children)},p={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},d=n.forwardRef((function(e,t){var r=e.components,o=e.mdxType,a=e.originalType,c=e.parentName,u=s(e,["components","mdxType","originalType","parentName"]),d=l(r),m=o,h=d["".concat(c,".").concat(m)]||d[m]||p[m]||a;return r?n.createElement(h,i(i({ref:t},u),{},{components:r})):n.createElement(h,i({ref:t},u))}));function m(e,t){var r=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var a=r.length,i=new Array(a);i[0]=d;var s={};for(var c in t)hasOwnProperty.call(t,c)&&(s[c]=t[c]);s.originalType=e,s.mdxType="string"==typeof e?e:o,i[1]=s;for(var l=2;l<a;l++)i[l]=r[l];return n.createElement.apply(null,i)}return n.createElement.apply(null,r)}d.displayName="MDXCreateElement"},2796:function(e,t,r){"use strict";r.r(t),r.d(t,{frontMatter:function(){return s},metadata:function(){return c},toc:function(){return l},default:function(){return p}});var n=r(2122),o=r(9756),a=(r(7294),r(3905)),i=["components"],s={title:"Serialization",sidebar_position:6},c={unversionedId:"architecture/serialization",id:"architecture/serialization",isDocsHomePage:!1,title:"Serialization Formats",description:"One of the driving forces in developing CosmWasm, besides security by design, was to include a very nice Developer UX. Key to this is the ability to inspect and debug messages sent on the blockchain, and parse results without needing complex libraries. Also not requiring downloading custom schemas and ABIs just to make a method call.",source:"@site/docs/architecture/serialization.md",sourceDirName:"architecture",slug:"/architecture/serialization",permalink:"/architecture/serialization",editUrl:"https://github.com/CosmWasm/docs/edit/master/docs/architecture/serialization.md",version:"current",sidebarPosition:6,frontMatter:{title:"Serialization",sidebar_position:6},sidebar:"tutorialSidebar",previous:{title:"Querying Contract State",permalink:"/architecture/query"},next:{title:"Contract Composition",permalink:"/architecture/composition"}},l=[{value:"JSON",id:"json",children:[]},{value:"Protobuf",id:"protobuf",children:[]},{value:"Cap&#39;n Proto",id:"capn-proto",children:[]},{value:"Credits",id:"credits",children:[]}],u={toc:l};function p(e){var t=e.components,r=(0,o.Z)(e,i);return(0,a.kt)("wrapper",(0,n.Z)({},u,r,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("p",null,"One of the driving forces in developing CosmWasm, besides security by design, was to include a very nice Developer UX. Key to this is the ability to inspect and debug messages sent on the blockchain, and parse results without needing complex libraries. Also not requiring downloading custom schemas and ABIs just to make a method call."),(0,a.kt)("h2",{id:"json"},"JSON"),(0,a.kt)("p",null,"The natural solution was to use JSON everywhere. It is self-describing, human-readable, and used in APIs everywhere. It does have some downsides, such as handling numbers over 2^53 (just use strings), no clear distinction between strings and base64-encoded binary, and no hard-coded schema. We auto-generate ",(0,a.kt)("a",{parentName:"p",href:"https://json-schema.org/"},"JSON Schema")," descriptors for the ",(0,a.kt)("a",{parentName:"p",href:"https://github.com/CosmWasm/cosmwasm-examples/tree/master/escrow/schema"},"public API of contracts"),", which can be used to inspect the supported API and optionally used in client side tooling for auto-validation of messages."),(0,a.kt)("p",null,"The feedback when developing and debugging with this has been positive, and we are quite happy with the Developer UX with this. It is too early to tell if the message size and free-form schema will become a hinderance in production. However, please note that contracts define their own parsing logic for messages, the codec is not enforced by the framework. We provide first-class support for json through ",(0,a.kt)("a",{parentName:"p",href:"https://github.com/CosmWasm/cosmwasm/blob/master/src/serde.rs"},(0,a.kt)("inlineCode",{parentName:"a"},"cosmwasm::serde"))," and ",(0,a.kt)("a",{parentName:"p",href:"https://github.com/CosmWasm/cosmwasm-template"},(0,a.kt)("inlineCode",{parentName:"a"},"cosmwasm-template")),", but anyone can swap this out - provided they provide client support for the format."),(0,a.kt)("p",null,"It is helpful to have consistency to aid client development, as well as contract-contract calls."),(0,a.kt)("h2",{id:"protobuf"},"Protobuf"),(0,a.kt)("p",null,"Protobuf is a well-known and widely-supported binary format. It gives a stricter schema guarantees than JSON and more compact format. Protocol Buffers and GRPC support has been added with Cosmos SDK v0.39.0 upgrade."),(0,a.kt)("h2",{id:"capn-proto"},"Cap'n Proto"),(0,a.kt)("p",null,(0,a.kt)("a",{parentName:"p",href:"https://capnproto.org/"},"Cap'n Proto")," is a super-lean encoding format with zero-copy reads, and no parsing needed. This has been ",(0,a.kt)("a",{parentName:"p",href:"https://github.com/CosmWasm/cosmwasm/issues/78"},"suggested for use in CosmWasm")," as an optional addition. This may be considered as an opt-in format for contracts desiring such efficiency or strict schema, or possibly just used for encoding internal data structures (",(0,a.kt)("inlineCode",{parentName:"p"},"Params"),")."),(0,a.kt)("h2",{id:"credits"},"Credits"),(0,a.kt)("p",null,"Much thanks to ",(0,a.kt)("a",{parentName:"p",href:"https://github.com/jtremback"},"Jehan Tremback"),", who insisted on a universal, human-readable format for all messages."))}p.isMDXComponent=!0}}]);